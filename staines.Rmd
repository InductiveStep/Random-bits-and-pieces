---
title: "Staines companies"
author: Andi
date: 6 Jan 2026
output: 
  html_notebook: 
    code_folding: none
---


Load up libraries:

```{r}
library(conflicted)
library(tidyverse)
library(flextable)
```

Read in the company list and SICS, codes for what the companies do:

```{r}
comps <- read.csv("Companies-House-search-results.csv") |>
  rename(sic = nature_of_business)
sics  <- read.csv("SIC07_CH_condensed_list_en.csv", colClasses = rep("character", 2)) |>
  rename(sic = SIC.Code) |>
  rename(activity = Description)
```

How many companies?

```{r}
nrow(comps)
```

Take a look at the top of the datasets:

```{r}
head(comps)
```

Some companies have multiple codes, so split those so it's one row per code (so those companies will appear more than once in the list):

```{r}
comps_long <- comps |>
  separate_rows(sic, sep = " ")
```


Now the codes:

```{r}
head(sics)
```


Glue the two lists together:

```{r}
dat <- left_join(comps_long, sics)
```

A helper function:

```{r}
prettify <- function(dat)
  dat |>
  flextable() |>
  autofit()
```



Count the company types:

```{r}
dat |>
  count(activity) |>
  arrange(desc(n)) |>
  prettify()
```






## Go fishing for interesting ones


Select some of the variables:

```{r}
thin_dat <- dat |> 
  dplyr::select(company_name, company_type, registered_office_address, activity)
```



These are some random things I spotted on going down the list of types:


```{r}
thin_dat |>
  dplyr::filter(activity == "Investigation activities") |>
  prettify()
```



Some science:

```{r}
thin_dat |>
  dplyr::filter(activity == "Other research and experimental development on natural sciences and engineering") |>
  prettify()
```



Wonder what these are...! Magna House features a lot:

```{r}
thin_dat |>
  dplyr::filter(activity == "Satellite telecommunications activities") |>
  prettify()
```


I'm always curious about holding companies:

```{r}
thin_dat |>
  dplyr::filter(activity == "Activities of other holding companies n.e.c.") |>
  flextable()
```


Art:

```{r}
thin_dat |>
  dplyr::filter(activity == "Artistic creation") |>
  prettify()
```



Performing arts:

```{r}
thin_dat |>
  dplyr::filter(activity == "Performing arts") |>
  prettify()
```


Broadcasting of some kind:

```{r}
thin_dat |>
  dplyr::filter(activity == "Television programming and broadcasting activities") |>
  flextable()
```


More:

```{r}
thin_dat |>
  dplyr::filter(activity == "Motion picture, video and television programme post-production activities") |>
  prettify()
```


Techie things:

```{r}
thin_dat |>
  dplyr::filter(activity == "Technical testing and analysis") |>
  prettify()
```


Political things -- this is "an organisation of neurodivergent members and supporters of the Labour party":

```{r}
thin_dat |>
  dplyr::filter(activity == "Activities of political organizations") |>
  prettify()
```




```{r}
thin_dat |>
  dplyr::filter(activity == "Cultural education") |>
  prettify()
```




Game/toy makers:

```{r}
thin_dat |>
  dplyr::filter(activity == "Manufacture of other games and toys, n.e.c.") |>
  prettify()
```



Various kinds of research (repeats some from above -- I just searched for "research" in the activity type:

```{r}
thin_dat |>
  dplyr::filter(str_detect(activity, "(?i)research")) |>
  prettify()
```

Consultancy:

```{r}
thin_dat |>
  dplyr::filter(str_detect(activity, "(?i)consult")) |>
  prettify()
```



Data (also in activity type):

```{r}
thin_dat |>
  dplyr::filter(str_detect(activity, "(?i)data")) |>
  prettify()
```


Software:

```{r}
thin_dat |>
  dplyr::filter(str_detect(activity, "(?i)software")) |>
  prettify()
```



Curious about Magna House:

```{r}
thin_dat |>
  dplyr::filter(str_detect(registered_office_address, "(?i)Magna House")) |>
  prettify()
```



Any other addresses with loads of companies?

```{r}
comps |>
  count(registered_office_address) |>
  arrange(desc(n)) |>
  slice_head(n = 10) |>
  prettify()
```


Menzies LLP is a business advisory and accountancy firm, so presumably manages a bunch of companies.



Try Centurion House

```{r}
thin_dat |>
  dplyr::filter(str_detect(registered_office_address, "(?i)Centurion House")) |>
  prettify()
```


```{r}
thin_dat |>
  dplyr::filter(str_detect(registered_office_address, "(?i)17 The Ryde")) |>
  prettify()
```




Finally... anything on Farnell Road?

```{r}
thin_dat |>
  dplyr::filter(str_detect(registered_office_address, "(?i)farnell")) |>
  prettify()
```




