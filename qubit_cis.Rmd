---
title: "R Notebook"
output: html_notebook
---

```{r}
library(tidyverse)
```



```{r}
dat <- read.csv(text = "Frequency	Outcome
85	0000000
78	0000001
75	0000010
82	0000011
73	0000100
97	0000101
65	0000110
90	0000111
90	0001000
102	0001001
75	0001010
75	0001011
65	0001100
81	0001101
91	0001110
76	0001111
68	0010000
81	0010001
80	0010010
79	0010011
80	0010100
85	0010101
70	0010110
86	0010111
85	0011000
88	0011001
78	0011010
78	0011011
64	0011100
89	0011101
71	0011110
89	0011111
75	0100000
77	0100001
75	0100010
78	0100011
74	0100100
85	0100101
73	0100110
77	0100111
87	0101000
98	0101001
93	0101010
65	0101011
75	0101100
79	0101101
85	0101110
59	0101111
69	0110000
78	0110001
78	0110010
95	0110011
69	0110100
84	0110101
84	0110110
61	0110111
76	0111000
82	0111001
69	0111010
87	0111011
77	0111100
72	0111101
89	0111110
82	0111111
74	1000000
82	1000001
72	1000010
75	1000011
75	1000100
74	1000101
73	1000110
61	1000111
64	1001000
73	1001001
80	1001010
78	1001011
58	1001100
67	1001101
67	1001110
73	1001111
72	1010000
68	1010001
70	1010010
70	1010011
63	1010100
57	1010101
67	1010110
75	1010111
69	1011000
71	1011001
67	1011010
83	1011011
73	1011100
84	1011101
69	1011110
77	1011111
102	1100000
87	1100001
89	1100010
96	1100011
67	1100100
88	1100101
66	1100110
92	1100111
82	1101000
95	1101001
72	1101010
99	1101011
78	1101100
82	1101101
78	1101110
91	1101111
76	1110000
95	1110001
88	1110010
75	1110011
69	1110100
88	1110101
68	1110110
83	1110111
61	1111000
81	1111001
75	1111010
70	1111011
75	1111100
107	1111101
75	1111110
91	1111111", sep = "\t", colClasses = c("numeric", "character"))
```


```{r}
dat
```

```{r}
qubit_labels <- do.call("rbind",
                        strsplit(dat$Outcome, "")) |>
  as.data.frame()

names(qubit_labels) <- paste0("q",0:(ncol(qubit_labels)-1))
qubit_labels
```


```{r}
dat2 <- cbind(dat, qubit_labels)
dat2
```


```{r}
dat_long <- dat2 |> pivot_longer(cols = paste0("q", 0:(ncol(qubit_labels) - 1)))
dat_long
```

```{r}
my_prop_l <- Vectorize(function(yes, no) {
  prop.test(yes, yes + no)$conf.int[1]
})

my_prop_u <- Vectorize(function(yes, no) {
  prop.test(yes, yes + no)$conf.int[2]
})
```

```{r}
dat_long |>
  group_by(name, value) |>
  summarise(n = sum(Frequency)) |>
  ungroup() |>
  pivot_wider(names_from = "value", values_from = "n") |>
  mutate(p = `1` / (`1`+`0`),
         ci_l = my_prop_l(`1`, `0`),
         ci_u = my_prop_u(`1`, `0`)) |>
  write.csv("clipboard")
```





